<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Conditional or Predictive Power for Multiple Contrast Test — powMCTInterim • DoseFinding</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Conditional or Predictive Power for Multiple Contrast Test — powMCTInterim"><meta name="description" content='Calculates the predictive or conditional power for a multiple contrast test based on
interim data, e.g. for a futility interim analysis. This function can also be applied
to longitudinal endpoints, where at the time of interim analysis incomplete data is
available. For more details see the vignette on longitudinal data analysis with
MCP-Mod: vignette("Longitudinal Data MCP-Mod", package = "DoseFinding").'><meta property="og:description" content='Calculates the predictive or conditional power for a multiple contrast test based on
interim data, e.g. for a futility interim analysis. This function can also be applied
to longitudinal endpoints, where at the time of interim analysis incomplete data is
available. For more details see the vignette on longitudinal data analysis with
MCP-Mod: vignette("Longitudinal Data MCP-Mod", package = "DoseFinding").'><meta property="og:image" content="https://openpharma.github.io/DoseFinding/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DoseFinding</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4-1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/analysis_normal.html">Continuous data MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/binary_data.html">Binary Data MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">MCP-Mod FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal_data.html">Longitudinal Data MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/mult_regimen.html">Multiple Regimen MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Overview DoseFinding package</a></li>
    <li><a class="dropdown-item" href="../articles/sample_size.html">Sample size calculations for MCP-Mod</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/DoseFinding/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Conditional or Predictive Power for Multiple Contrast Test</h1>
      <small class="dont-index">Source: <a href="https://github.com/openpharma/DoseFinding/blob/master/R/powMCTInterim.R" class="external-link"><code>R/powMCTInterim.R</code></a></small>
      <div class="d-none name"><code>powMCTInterim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the predictive or conditional power for a multiple contrast test based on
interim data, e.g. for a futility interim analysis. This function can also be applied
to longitudinal endpoints, where at the time of interim analysis incomplete data is
available. For more details see the vignette on longitudinal data analysis with
MCP-Mod: <code>vignette("Longitudinal Data MCP-Mod", package = "DoseFinding")</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">powMCTInterim</span><span class="op">(</span></span>
<span>  <span class="va">contMat</span>,</span>
<span>  <span class="va">mu_0t</span>,</span>
<span>  <span class="va">S_0t</span>,</span>
<span>  <span class="va">S_01</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"predictive"</span>, <span class="st">"conditional"</span><span class="op">)</span>,</span>
<span>  mu_assumed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"one.sided"</span>, <span class="st">"two.sided"</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="mvtnorm-control.html">mvtnorm.control</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-contmat">contMat<a class="anchor" aria-label="anchor" href="#arg-contmat"></a></dt>
<dd><p>Contrast matrix to use. The individual contrasts should be
saved in the columns of the matrix</p></dd>


<dt id="arg-mu-t">mu_0t<a class="anchor" aria-label="anchor" href="#arg-mu-t"></a></dt>
<dd><p>The first stage estimates</p></dd>


<dt id="arg-s-t">S_0t<a class="anchor" aria-label="anchor" href="#arg-s-t"></a></dt>
<dd><p>The covariance matrix for the first stage estimates</p></dd>


<dt id="arg-s-">S_01<a class="anchor" aria-label="anchor" href="#arg-s-"></a></dt>
<dd><p>The covariance matrix anticipated for the estimates at
study end</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance level to use</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Whether predictive power (for a flat prior) or
conditional power should be calculated. For conditional power
mu_assumed needs to be specified.</p></dd>


<dt id="arg-mu-assumed">mu_assumed<a class="anchor" aria-label="anchor" href="#arg-mu-assumed"></a></dt>
<dd><p>Mean vector to assume for the second stage (only used when type is
<samp>conditional</samp>). If <code>NULL</code> (default), the first stage estimates <code>mu_0t</code> are used.</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>Character determining the alternative for the multiple
contrast trend test.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list specifying additional control parameters for the <samp>pmvnorm</samp> calls in the code, see also
<samp>mvtnorm.control</samp> for details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Numeric containing the calculated power values</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bornkamp B, Zhou J, Xi D, Cao W (2024).
“Futility analyses for the MCP-Mod methodology based on longitudinal models.”
2406.19965, <a href="https://arxiv.org/abs/2406.19965" class="external-link">https://arxiv.org/abs/2406.19965</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="powMCT.html">powMCT()</a></code> <code><a href="MCTtest.html">MCTtest()</a></code>, <code><a href="optContr.html">optContr()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Setup the scenario.</span></span></span>
<span class="r-in"><span><span class="va">doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="fu"><a href="Mods.html">Mods</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  emax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sigEmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  quadratic <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  doses <span class="op">=</span> <span class="va">doses</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">contMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="optContr.html">optContr</a></span><span class="op">(</span>models <span class="op">=</span> <span class="va">mods</span>, w <span class="op">=</span> <span class="va">w</span><span class="op">)</span><span class="op">$</span><span class="va">contMat</span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span></span>
<span class="r-in"><span><span class="va">n_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">531</span> <span class="op">*</span> <span class="va">w</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">n_final</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S_0t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n_final</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## assumed interim estimate</span></span></span>
<span class="r-in"><span><span class="va">mu_0t</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">doses</span> <span class="op">/</span> <span class="op">(</span><span class="va">doses</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">0</span>, <span class="fl">0.382</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## assumed mu (needed for conditional power)</span></span></span>
<span class="r-in"><span><span class="va">mu_assumed</span> <span class="op">&lt;-</span> <span class="fl">0.135</span> <span class="op">*</span> <span class="va">doses</span> <span class="op">/</span> <span class="op">(</span><span class="va">doses</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate predictive and conditional power.</span></span></span>
<span class="r-in"><span><span class="fu">powMCTInterim</span><span class="op">(</span></span></span>
<span class="r-in"><span>  contMat <span class="op">=</span> <span class="va">contMat</span>, S_0t <span class="op">=</span> <span class="va">S_0t</span>, S_01 <span class="op">=</span> <span class="va">S_01</span>, mu_0t <span class="op">=</span> <span class="va">mu_0t</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"predictive"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6973523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"error")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0003906307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"msg")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal Completion"</span>
<span class="r-in"><span><span class="fu">powMCTInterim</span><span class="op">(</span></span></span>
<span class="r-in"><span>  contMat <span class="op">=</span> <span class="va">contMat</span>, S_0t <span class="op">=</span> <span class="va">S_0t</span>, S_01 <span class="op">=</span> <span class="va">S_01</span>, mu_0t <span class="op">=</span> <span class="va">mu_0t</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"conditional"</span>, mu_assumed <span class="op">=</span> <span class="va">mu_assumed</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8650528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"error")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0001563329</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"msg")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal Completion"</span>
<span class="r-in"><span><span class="fu">powMCTInterim</span><span class="op">(</span></span></span>
<span class="r-in"><span>  contMat <span class="op">=</span> <span class="va">contMat</span>, S_0t <span class="op">=</span> <span class="va">S_0t</span>, S_01 <span class="op">=</span> <span class="va">S_01</span>, mu_0t <span class="op">=</span> <span class="va">mu_0t</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"predictive"</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6959777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"error")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0004569151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"msg")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal Completion"</span>
<span class="r-in"><span><span class="fu">powMCTInterim</span><span class="op">(</span></span></span>
<span class="r-in"><span>  contMat <span class="op">=</span> <span class="va">contMat</span>, S_0t <span class="op">=</span> <span class="va">S_0t</span>, S_01 <span class="op">=</span> <span class="va">S_01</span>, mu_0t <span class="op">=</span> <span class="va">mu_0t</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"predictive"</span>, control <span class="op">=</span> <span class="fu"><a href="mvtnorm-control.html">mvtnorm.control</a></span><span class="op">(</span>maxpts <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6974567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"error")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0003386685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"msg")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal Completion"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bjoern Bornkamp, Jose Pinheiro, Frank Bretz, Ludger Sandig, Marius Thomas, Daniel Sabanes Bove, Novartis Pharma AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

