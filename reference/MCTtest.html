<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Performs multiple contrast test — MCTtest • DoseFinding</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Performs multiple contrast test — MCTtest"><meta name="description" content='This function performs a multiple contrast test. The contrasts are
  either directly specified in contMat or optimal contrasts
  derived from the models argument. The directionality of the
  data (i.e. whether an increase or decrease in the response variable is
  beneficial is inferred from the models object, see
  Mods).
For type = "normal" an ANCOVA model based on a homoscedastic
  normality assumption (with additive covariates specified in
  addCovars) is fitted.
For type = "general" it is assumed multivariate normally
  distributed estimates are specified in resp with covariance
  given by S, and the contrast test statistic is calculated based
  on this assumption. Degrees of freedom specified in df.'><meta property="og:description" content='This function performs a multiple contrast test. The contrasts are
  either directly specified in contMat or optimal contrasts
  derived from the models argument. The directionality of the
  data (i.e. whether an increase or decrease in the response variable is
  beneficial is inferred from the models object, see
  Mods).
For type = "normal" an ANCOVA model based on a homoscedastic
  normality assumption (with additive covariates specified in
  addCovars) is fitted.
For type = "general" it is assumed multivariate normally
  distributed estimates are specified in resp with covariance
  given by S, and the contrast test statistic is calculated based
  on this assumption. Degrees of freedom specified in df.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DoseFinding</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/analysis_normal.html">Continuous data MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/binary_data.html">Binary Data MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">MCP-Mod FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/mult_regimen.html">Multiple Regimen MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Overview DoseFinding package</a></li>
    <li><a class="dropdown-item" href="../articles/sample_size.html">Sample size calculations for MCP-Mod</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/DoseFinding/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Performs multiple contrast test</h1>

      <div class="d-none name"><code>MCTtest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs a multiple contrast test. The contrasts are
  either directly specified in <samp>contMat</samp> or optimal contrasts
  derived from the <samp>models</samp> argument. The directionality of the
  data (i.e. whether an increase or decrease in the response variable is
  beneficial is inferred from the <samp>models</samp> object, see
  <code><a href="Mods.html">Mods</a></code>).</p>
<p>For <samp>type = "normal"</samp> an ANCOVA model based on a homoscedastic
  normality assumption (with additive covariates specified in
  <samp>addCovars</samp>) is fitted.</p>
<p>For <samp>type = "general"</samp> it is assumed multivariate normally
  distributed estimates are specified in <samp>resp</samp> with covariance
  given by <samp>S</samp>, and the contrast test statistic is calculated based
  on this assumption. Degrees of freedom specified in <samp>df</samp>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MCTtest</span><span class="op">(</span><span class="va">dose</span>, <span class="va">resp</span>, data <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">models</span>, S <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"general"</span><span class="op">)</span>,</span>
<span>        addCovars <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>, placAdj <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        critV <span class="op">=</span> <span class="cn">NULL</span>, pVal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"one.sided"</span>, <span class="st">"two.sided"</span><span class="op">)</span>, na.action <span class="op">=</span> <span class="va">na.fail</span>,</span>
<span>        mvtcontrol <span class="op">=</span> <span class="fu"><a href="mvtnorm-control.html">mvtnorm.control</a></span><span class="op">(</span><span class="op">)</span>, contMat <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-dose-resp">dose, resp<a class="anchor" aria-label="anchor" href="#arg-dose-resp"></a></dt>
<dd><p>Either vectors of equal length specifying dose and response values,
    or names of variables in the data frame specified in <samp>data</samp>.</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame containing the variables referenced in dose and resp if
    <samp>data</samp> is not specified it is assumed that <samp>dose</samp> and
    <samp>resp</samp> are variables referenced from data (and no vectors)</p></dd>

  <dt id="arg-models">models<a class="anchor" aria-label="anchor" href="#arg-models"></a></dt>
<dd><p>An object of class <samp>Mods</samp>, see <code><a href="Mods.html">Mods</a></code> for
    details</p></dd>

  <dt id="arg-s">S<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>The covariance matrix of <samp>resp</samp> when <samp>type = "general"</samp>,
    see Description.</p></dd>

  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Determines whether inference is based on an ANCOVA model under a
    homoscedastic normality assumption (when <samp>type = "normal"</samp>), or
    estimates at the doses and their covariance matrix and degrees of
    freedom are specified directly in <samp>resp</samp>, <samp>S</samp> and
    <samp>df</samp>. See also <code><a href="fitMod.html">fitMod</a></code> and Pinheiro et al. (2014).</p></dd>

  <dt id="arg-addcovars">addCovars<a class="anchor" aria-label="anchor" href="#arg-addcovars"></a></dt>
<dd><p>Formula specifying additive linear covariates (for <samp>type = "normal"</samp>)</p></dd>

<dt id="arg-placadj">placAdj<a class="anchor" aria-label="anchor" href="#arg-placadj"></a></dt>
<dd><p>Logical, if true, it is assumed that placebo-adjusted estimates are
  specified in <samp>resp</samp> (only possible for <samp>type = "general"</samp>).</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance level for the multiple contrast test</p></dd>

<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>Specify the degrees of freedom to use in case <samp>type = "general"</samp>.
  If this argument is missing <samp>df = Inf</samp> is used (which corresponds
  to the multivariate normal distribution).
  For type = "normal" the degrees of freedom deduced from the AN(C)OVA fit are
  used and this argument is ignored.</p></dd>

<dt id="arg-critv">critV<a class="anchor" aria-label="anchor" href="#arg-critv"></a></dt>
<dd><p>Supply a pre-calculated critical value. If this argument is NULL, no
  critical value will be calculated and the test decision is based on
  the p-values. If <samp>critV = TRUE</samp> the critical value will be calculated.</p></dd>

  <dt id="arg-pval">pVal<a class="anchor" aria-label="anchor" href="#arg-pval"></a></dt>
<dd><p>Logical determining, whether p-values should be calculated.</p></dd>

<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>Character determining the alternative for the multiple contrast
  trend test.</p></dd>

<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>A function which indicates what should happen when
  the data contain NAs.</p></dd>

<dt id="arg-mvtcontrol">mvtcontrol<a class="anchor" aria-label="anchor" href="#arg-mvtcontrol"></a></dt>
<dd><p>A list specifying additional control parameters for the <samp>qmvt</samp>
  and <samp>pmvt</samp> calls in the code, see also <code><a href="mvtnorm-control.html">mvtnorm.control</a></code>
  for details.</p></dd>

<dt id="arg-contmat">contMat<a class="anchor" aria-label="anchor" href="#arg-contmat"></a></dt>
<dd><p>Contrast matrix to apply to the ANCOVA dose-response estimates. The
  contrasts need to be in the columns of the matrix (i.e. the column
  sums need to be 0).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Integrals over the multivariate t and multivariate normal distribution
  are calculated using the <samp>mvtnorm</samp> package.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class MCTtest, a list containing the output.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hothorn, T., Bretz, F., and Westfall, P. (2008). Simultaneous
  Inference in General Parametric Models, <em>Biometrical Journal</em>,
  <b>50</b>, 346–363</p>
<p>Pinheiro, J. C., Bornkamp, B., Glimm, E. and Bretz, F. (2014)
  Model-based dose finding under model uncertainty using general
  parametric models, <em>Statistics in Medicine</em>, <b>33</b>,
  1646–1661</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Bjoern Bornkamp</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="powMCT.html">powMCT</a></code>, <code><a href="optContr.html">optContr</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## example without covariates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">biom</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## define shapes for which to calculate optimal contrasts</span></span></span>
<span class="r-in"><span><span class="va">modlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="Mods.html">Mods</a></span><span class="op">(</span>emax <span class="op">=</span> <span class="fl">0.05</span>, linear <span class="op">=</span> <span class="cn">NULL</span>, logistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                linInt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, doses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">MCTtest</span><span class="op">(</span><span class="va">dose</span>, <span class="va">resp</span>, <span class="va">biom</span>, models<span class="op">=</span><span class="va">modlist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## now calculate critical value (but not p-values)</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">MCTtest</span><span class="op">(</span><span class="va">dose</span>, <span class="va">resp</span>, <span class="va">biom</span>, models<span class="op">=</span><span class="va">modlist</span>, critV <span class="op">=</span> <span class="cn">TRUE</span>, pVal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## now hand over critical value</span></span></span>
<span class="r-in"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">MCTtest</span><span class="op">(</span><span class="va">dose</span>, <span class="va">resp</span>, <span class="va">biom</span>, models<span class="op">=</span><span class="va">modlist</span>, critV <span class="op">=</span> <span class="fl">2.24</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## example with covariates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">IBScovars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">modlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="Mods.html">Mods</a></span><span class="op">(</span>emax <span class="op">=</span> <span class="fl">0.05</span>, linear <span class="op">=</span> <span class="cn">NULL</span>, logistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                linInt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, doses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">MCTtest</span><span class="op">(</span><span class="va">dose</span>, <span class="va">resp</span>, <span class="va">IBScovars</span>, models <span class="op">=</span> <span class="va">modlist</span>, addCovars <span class="op">=</span> <span class="op">~</span><span class="va">gender</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrasts:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     emax linear logistic linInt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 -0.894 -0.616   -0.894 -0.521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.207 -0.338    0.228 -0.573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.226  0.002    0.227  0.373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.225  0.315    0.217  0.357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.236  0.638    0.222  0.365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast Correlation:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           emax linear logistic linInt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> emax     1.000  0.715    1.000  0.617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linear   0.715  1.000    0.698  0.863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logistic 1.000  0.698    1.000  0.598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt   0.617  0.863    0.598  1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          t-Stat   adj-p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> emax      3.178 0.00187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logistic  3.164 0.00210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linear    2.640 0.01035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt    2.247 0.02764</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## example using general approach (fitted on placebo-adjusted scale)</span></span></span>
<span class="r-in"><span><span class="va">ancMod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">resp</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dose</span><span class="op">)</span><span class="op">+</span><span class="va">gender</span>, data<span class="op">=</span><span class="va">IBScovars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## extract estimates and information to feed into MCTtest</span></span></span>
<span class="r-in"><span><span class="va">drEst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">ancMod</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">ancMod</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">doses</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span></span>
<span class="r-in"><span><span class="fu">MCTtest</span><span class="op">(</span><span class="va">doses</span>, <span class="va">drEst</span>, S <span class="op">=</span> <span class="va">vc</span>, models <span class="op">=</span> <span class="va">modlist</span>, placAdj <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>        type <span class="op">=</span> <span class="st">"general"</span>, df <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrasts:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    emax linear logistic linInt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.462 -0.429    0.511 -0.672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.505  0.002    0.507  0.437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.504  0.400    0.485  0.418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.527  0.810    0.497  0.428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast Correlation:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           emax linear logistic linInt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> emax     1.000  0.715    1.000  0.617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linear   0.715  1.000    0.698  0.863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logistic 1.000  0.698    1.000  0.598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt   0.617  0.863    0.598  1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          t-Stat   adj-p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> emax      3.178 0.00187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logistic  3.164 0.00203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linear    2.640 0.00988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt    2.247 0.02681</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## example with general alternatives handed over</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">biom</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## calculate contrast matrix for the step-contrasts</span></span></span>
<span class="r-in"><span><span class="co">## represent them as linInt models</span></span></span>
<span class="r-in"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="Mods.html">Mods</a></span><span class="op">(</span>linInt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                doses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.05</span>,<span class="fl">0.2</span>,<span class="fl">0.6</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="MCTtest-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## now calculate optimal contrasts for these means</span></span></span>
<span class="r-in"><span><span class="co">## use weights from actual sample sizes</span></span></span>
<span class="r-in"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">biom</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">contMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="optContr.html">optContr</a></span><span class="op">(</span><span class="va">models</span>, w <span class="op">=</span> <span class="va">weights</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## plot contrasts</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">contMat</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="MCTtest-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## perform multiple contrast test</span></span></span>
<span class="r-in"><span><span class="fu">MCTtest</span><span class="op">(</span><span class="va">dose</span>, <span class="va">resp</span>, data<span class="op">=</span><span class="va">biom</span>, contMat <span class="op">=</span> <span class="va">contMat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrasts:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      linInt1 linInt2 linInt3 linInt4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0     -0.894  -0.548  -0.365  -0.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.05   0.224  -0.548  -0.365  -0.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2    0.224   0.365  -0.365  -0.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6    0.224   0.365   0.548  -0.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      0.224   0.365   0.548   0.894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast Correlation:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         linInt1 linInt2 linInt3 linInt4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt1   1.000   0.612   0.408   0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt2   0.612   1.000   0.667   0.408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt3   0.408   0.667   1.000   0.612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt4   0.250   0.408   0.612   1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         t-Stat   adj-p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt2  3.418 0.00179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt3  2.780 0.01098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt1  2.486 0.02423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linInt4  1.753 0.11949</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## example for using the Dunnett contrasts</span></span></span>
<span class="r-in"><span><span class="co">## Dunnett contrasts</span></span></span>
<span class="r-in"><span><span class="va">doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">biom</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">contMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">contMat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">doses</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">contMat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="va">doses</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">MCTtest</span><span class="op">(</span><span class="va">dose</span>, <span class="va">resp</span>, data<span class="op">=</span><span class="va">biom</span>, contMat <span class="op">=</span> <span class="va">contMat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrasts:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      D0.05 D0.2 D0.6 D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0       -1   -1   -1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.05     1    0    0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2      0    1    0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6      0    0    1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        0    0    0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast Correlation:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       D0.05 D0.2 D0.6  D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D0.05   1.0  0.5  0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D0.2    0.5  1.0  0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D0.6    0.5  0.5  1.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D1      0.5  0.5  0.5 1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       t-Stat  adj-p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D1     2.680 0.0151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D0.6   2.617 0.0178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D0.2   2.066 0.0654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D0.05  0.497 0.6034</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bjoern Bornkamp, Jose Pinheiro, Frank Bretz, Ludger Sandig, Marius Thomas, Novartis Pharma AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

