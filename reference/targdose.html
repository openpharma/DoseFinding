<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate dose estimates for a fitted dose-response model (via fitMod(), bFitMod()) or maFitMod()) or a Mods() object — Target doses • DoseFinding</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate dose estimates for a fitted dose-response model (via fitMod(), bFitMod()) or maFitMod()) or a Mods() object — Target doses"><meta name="description" content="The TD (target dose) is defined as the dose that achieves a target effect of Delta over placebo (if
there are multiple such doses, the smallest is chosen):
$$TD_\Delta = \min \{x|f(x) &amp;gt; f(0)+\Delta\}$$
If a decreasing trend is beneficial the definition of the TD is
$$TD_\Delta = \min \{x|f(x) &amp;lt; f(0)-\Delta\}$$
When \(\Delta\) is the clinical relevance threshold, then the TD is similar to the usual definition of the
minimum effective dose (MED).
The ED (effective dose) is defined as the dose that achieves a certain percentage p of the full effect size (within
the observed dose-range!) over placebo (if there are multiple such doses, the smallest is chosen).
$$ED_p=\min\{x|f(x) &amp;gt; f(0) + p(f(dmax)-f(0))$$
Note that this definition of the EDp is different from traditional definition based on the Emax model,
where the EDp is defined relative to the asymptotic maximum effect (rather than the maximum effect in the observed dose-range).
ED or TD calculation for bootstrap model averaging (maFit) objects is based on first calculating the pointwise median dose-response curve estimate. Then calculating the dose estimate based on this curve."><meta property="og:description" content="The TD (target dose) is defined as the dose that achieves a target effect of Delta over placebo (if
there are multiple such doses, the smallest is chosen):
$$TD_\Delta = \min \{x|f(x) &amp;gt; f(0)+\Delta\}$$
If a decreasing trend is beneficial the definition of the TD is
$$TD_\Delta = \min \{x|f(x) &amp;lt; f(0)-\Delta\}$$
When \(\Delta\) is the clinical relevance threshold, then the TD is similar to the usual definition of the
minimum effective dose (MED).
The ED (effective dose) is defined as the dose that achieves a certain percentage p of the full effect size (within
the observed dose-range!) over placebo (if there are multiple such doses, the smallest is chosen).
$$ED_p=\min\{x|f(x) &amp;gt; f(0) + p(f(dmax)-f(0))$$
Note that this definition of the EDp is different from traditional definition based on the Emax model,
where the EDp is defined relative to the asymptotic maximum effect (rather than the maximum effect in the observed dose-range).
ED or TD calculation for bootstrap model averaging (maFit) objects is based on first calculating the pointwise median dose-response curve estimate. Then calculating the dose estimate based on this curve."><meta property="og:image" content="https://openpharma.github.io/DoseFinding/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DoseFinding</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3-1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/analysis_normal.html">Continuous data MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/binary_data.html">Binary Data MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">MCP-Mod FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal_data.html">Longitudinal Data MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/mult_regimen.html">Multiple Regimen MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Overview DoseFinding package</a></li>
    <li><a class="dropdown-item" href="../articles/sample_size.html">Sample size calculations for MCP-Mod</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/DoseFinding/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate dose estimates for a fitted dose-response model (via <code><a href="fitMod.html">fitMod()</a></code>, <code><a href="bFitMod.html">bFitMod()</a></code>) or <code><a href="maFitMod.html">maFitMod()</a></code>) or a <code><a href="Mods.html">Mods()</a></code> object</h1>
      <small class="dont-index">Source: <a href="https://github.com/openpharma/DoseFinding/blob/master/R/Mods.R" class="external-link"><code>R/Mods.R</code></a></small>
      <div class="d-none name"><code>targdose.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The TD (target dose) is defined as the dose that achieves a target effect of Delta over placebo (if
there are multiple such doses, the smallest is chosen):</p>
<p>$$TD_\Delta = \min \{x|f(x) &gt; f(0)+\Delta\}$$</p>
<p>If a decreasing trend is beneficial the definition of the TD is</p>
<p>$$TD_\Delta = \min \{x|f(x) &lt; f(0)-\Delta\}$$</p>
<p>When \(\Delta\) is the clinical relevance threshold, then the TD is similar to the usual definition of the
minimum effective dose (MED).</p>
<p>The ED (effective dose) is defined as the dose that achieves a certain percentage p of the full effect size (within
the observed dose-range!) over placebo (if there are multiple such doses, the smallest is chosen).
$$ED_p=\min\{x|f(x) &gt; f(0) + p(f(dmax)-f(0))$$</p>
<p>Note that this definition of the EDp is different from traditional definition based on the Emax model,
where the EDp is defined relative to the <em>asymptotic</em> maximum effect (rather than the maximum effect in the observed dose-range).</p>
<p>ED or TD calculation for bootstrap model averaging (maFit) objects is based on first calculating the pointwise median dose-response curve estimate. Then calculating the dose estimate based on this curve.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">TD</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">Delta</span>,</span>
<span>  TDtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"continuous"</span>, <span class="st">"discrete"</span><span class="op">)</span>,</span>
<span>  direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"increasing"</span>, <span class="st">"decreasing"</span><span class="op">)</span>,</span>
<span>  doses <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ED</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  EDtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"continuous"</span>, <span class="st">"discrete"</span><span class="op">)</span>,</span>
<span>  direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"increasing"</span>, <span class="st">"decreasing"</span><span class="op">)</span>,</span>
<span>  doses <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class c(Mods, fullMod), DRMod, bFitMod or maFit</p></dd>


<dt id="arg-delta-p">Delta, p<a class="anchor" aria-label="anchor" href="#arg-delta-p"></a></dt>
<dd><p>Delta: The target effect size use for the target dose (TD) (Delta should be &gt; 0).</p>
<p>p: The percentage of the dose to use for the effective dose.</p></dd>


<dt id="arg-tdtype-edtype">TDtype, EDtype<a class="anchor" aria-label="anchor" href="#arg-tdtype-edtype"></a></dt>
<dd><p>character that determines, whether the dose should be treated as a continuous
variable when calculating the TD/ED or whether the TD/ED should be calculated based on a grid of doses specified in <samp>doses</samp></p></dd>


<dt id="arg-direction">direction<a class="anchor" aria-label="anchor" href="#arg-direction"></a></dt>
<dd><p>Direction to be used in defining the TD. This depends on whether an increasing
or decreasing of the response variable is beneficial. In case of ED calculation only needed for maFit objects.</p></dd>


<dt id="arg-doses">doses<a class="anchor" aria-label="anchor" href="#arg-doses"></a></dt>
<dd><p>Dose levels to be used if <samp>TDtype</samp> or <samp>EDtype</samp> are
equal to <samp>"discrete"</samp>. Needs to include placebo, and may not exceed the dose range of the model(s) provided in <samp>object</samp>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns the dose estimate</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="Mods.html">Mods()</a></code>, <code><a href="drmodels.html">drmodels()</a></code>,
<code><a href="fitMod.html">fitMod()</a></code>, <code><a href="bFitMod.html">bFitMod()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Bjoern Bornkamp</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## example for creating a "full-model" candidate set placebo response</span></span></span>
<span class="r-in"><span><span class="co">## and maxEff already fixed in Mods call</span></span></span>
<span class="r-in"><span><span class="va">doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fmodels</span> <span class="op">&lt;-</span> <span class="fu"><a href="Mods.html">Mods</a></span><span class="op">(</span>linear <span class="op">=</span> <span class="cn">NULL</span>, emax <span class="op">=</span> <span class="fl">25</span>,</span></span>
<span class="r-in"><span>                logistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">10.88111</span><span class="op">)</span>, exponential <span class="op">=</span> <span class="fl">85</span>,</span></span>
<span class="r-in"><span>                betaMod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.33</span>, <span class="fl">2.31</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.39</span>, <span class="fl">1.39</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                linInt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                doses<span class="op">=</span><span class="va">doses</span>, placEff <span class="op">=</span> <span class="fl">0</span>, maxEff <span class="op">=</span> <span class="fl">0.4</span>,</span></span>
<span class="r-in"><span>                addArgs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scal<span class="op">=</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## calculate doses giving an improvement of 0.3 over placebo</span></span></span>
<span class="r-in"><span><span class="fu">TD</span><span class="op">(</span><span class="va">fmodels</span>, Delta<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      linear        emax    logistic exponential    betaMod1    betaMod2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  112.500000   45.000000   62.095220  130.265330    4.880978   56.762044 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     linInt1     linInt2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   21.250000   43.750000 </span>
<span class="r-in"><span><span class="co">## discrete version</span></span></span>
<span class="r-in"><span><span class="fu">TD</span><span class="op">(</span><span class="va">fmodels</span>, Delta<span class="op">=</span><span class="fl">0.3</span>, TDtype <span class="op">=</span> <span class="st">"discrete"</span>, doses<span class="op">=</span><span class="va">doses</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      linear        emax    logistic exponential    betaMod1    betaMod2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         150          50         100         150          10         100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     linInt1     linInt2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          25          50 </span>
<span class="r-in"><span><span class="co">## doses giving 50% of the maximum effect</span></span></span>
<span class="r-in"><span><span class="fu">ED</span><span class="op">(</span><span class="va">fmodels</span>, p<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      linear        emax    logistic exponential    betaMod1    betaMod2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   75.000000   18.750000   50.215409  104.517639    1.255838   37.337384 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     linInt1     linInt2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   17.500000   37.500000 </span>
<span class="r-in"><span><span class="fu">ED</span><span class="op">(</span><span class="va">fmodels</span>, p<span class="op">=</span><span class="fl">0.5</span>, EDtype <span class="op">=</span> <span class="st">"discrete"</span>, doses<span class="op">=</span><span class="va">doses</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      linear        emax    logistic exponential    betaMod1    betaMod2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         100          25         100         150          10          50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     linInt1     linInt2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          25          50 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fmodels</span>, plotTD <span class="op">=</span> <span class="cn">TRUE</span>, Delta <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="targdose-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bjoern Bornkamp, Jose Pinheiro, Frank Bretz, Ludger Sandig, Marius Thomas, Novartis Pharma AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

